(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{130:function(e,t,n){},152:function(e){e.exports=[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}]},153:function(e,t,n){e.exports=n.p+"static/media/rooms-white.1e9cdb15.svg"},154:function(e,t,n){e.exports=n(289)},159:function(e,t,n){},160:function(e,t,n){},209:function(e,t){},239:function(e,t,n){},240:function(e,t,n){},253:function(e,t,n){},254:function(e,t,n){},288:function(e,t,n){},289:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(22),s=n.n(r),l=(n(159),n(3)),i=n(4),c=n(7),m=n(5),u=n(6),p=(n(160),n(44)),d=n.n(p),h=function e(){var t=this;Object(l.a)(this,e),this.getAllRooms=function(){return t.service.get("getAllRooms",{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.getOneRoom=function(e){return t.service.get("getOneRoom/".concat(e),{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.postRoom=function(e){return t.service.post("newRoom",e,{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.updateRoom=function(e,n){return t.service.put("updateRoom/".concat(e),n).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.handleUpload=function(e){return t.service.post("/upload",e,{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.deleteRoom=function(e){return t.service.delete("/deleteRoom/".concat(e),{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.service=d.a.create({baseURL:"".concat("https://rooms-ih.herokuapp.com/api/","rooms/")})},f=function e(){var t=this;Object(l.a)(this,e),this.getAllUsers=function(){return t.service.get("getAllUsers",{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.updateUser=function(e,n){return t.service.put("updateUser/".concat(e),n).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.updateFollowing=function(e,n,a){return console.log("0000000000000000000000000000000000000000000000000000000000000 "),t.service.put("updateFollowing",{roomId:e,userId:n,action:a}).then(function(e){return console.log("THEN---------------------------------------------------------")}).catch(function(){return console.log("111111111111111111111111111111111111111111111111111111")})},this.postUser=function(e){return t.service.post("newUser",e,{withCredentials:!0}).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.getOneUser=function(e){return t.service.get("getOneUser/".concat(e)).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.service=d.a.create({baseURL:"".concat("https://rooms-ih.herokuapp.com/api/","users/")})},g=(n(88),n(89),n(13)),v=n(35),b=n(36);function E(){var e=Object(v.a)(["\n  text-align: ",";\n \n\n\n"]);return E=function(){return e},e}function y(){var e=Object(v.a)(["\n  background: ",";\n  border-radius: 10px;\n  padding: 4px 8px;\n  margin-top: 10px;\n  display: inline-block;\n  text-align: ",";\n  max-height: 571px;\n"]);return y=function(){return e},e}var w=b.a.div(y(),function(e){return e.server?"gray":"green"},function(e){return e.server?"left":"right"}),O=b.a.div(E(),function(e){return e.server?"left":"right"}),j=function(e){var t=e.children,n=e.server,a=void 0!==n&&n;return o.a.createElement(O,{server:a,className:"messageWrapper"},o.a.createElement(w,{server:a},t))};function S(){var e=Object(v.a)(["\n  width: 15%;\n  padding: 5px;\n  font-size: 20px;\n  box-sizing: border-box;\n  display: inline-block;\n  text-align: center;\n  background: tomato;\n  color: white;\n  user-select: none;\n  cursor: pointer;\n  border-radius:13px;\n"]);return S=function(){return e},e}function C(){var e=Object(v.a)(["\n  width: 79%;\n  padding: 5px;\n  font-size: 20px;\n  box-sizing: border-box;\n  border: 0;\n  border-radius:13px;\n  margin-left: 28px;\n  @media (max-width: 400px) {  \n    width: 207px;\n    }\n  @media (min-width:460) and (max-width: 568px){  \n    width: 278px;\n    }\n  // @media (min-width: 400px) and (max-width: 451px) {  \n  //   width: 51%;\n  //   }\n"]);return C=function(){return e},e}var k=b.a.input(C()),U=b.a.a(S()),I=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this))).state={text:""},e}return Object(u.a)(t,e),Object(i.a)(t,[{key:"send",value:function(){var e=this.state.text,t=this.props.newMessage;t?(console.log("Sending message: ".concat(e)),t(e)):console.log("Missing callback"),this.setState({text:""})}},{key:"render",value:function(){var e=this,t=this.state.text;return o.a.createElement("div",{className:"input-chat"},o.a.createElement(k,{value:t,onKeyPress:function(t){"Enter"===t.key&&e.send()},onChange:function(t){e.setState({text:t.target.value})}}),o.a.createElement(U,{onClick:function(){return e.send()}},"Send"))}}]),t}(a.Component),N=n(61),R=n(147);function x(){var e=Object(v.a)(["\n  //border: 1px solid white;\n  padding: 0px 0px 0px 0px;\n  width: 500px;\n  max-height:500px;\n  overflow-y: scroll;\n\n"]);return x=function(){return e},e}var T=n.n(R)()("https://rooms-ih.herokuapp.com"),M=b.a.div(x()),L=Object(N.c)("messages","setMessages",[]),_=Object(N.b)({componentDidMount:function(){var e=this.props,t=e.messages,n=e.setMessages;console.log("Chat Ready"),T.emit("create","room1",function(e){console.log("Mensaje del servidor: ".concat(e)),t.push({type:"server",msg:e}),n(t)}),T.on("front",function(e){console.log("Mensaje del servidor: ".concat(e)),t.push({type:"server",msg:e}),n(t)})}}),W=Object(N.a)(L,_)(function(e){var t=e.messages,n=e.setMessages;return o.a.createElement("div",{className:"chat-container"},o.a.createElement("div",{className:"message-container"},o.a.createElement(M,null,t.map(function(e,t){var n=e.type,a=e.msg;return o.a.createElement(j,{server:"server"===n,key:t},a)}))),o.a.createElement(I,{newMessage:function(e){T.emit("mensajeria",e),t.push({type:"me",msg:e}),n(t)}}))}),D=n(21),F=(n(212),n(213),n(148)),A=n.n(F),z=function(e){function t(e,n){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e,n))).state={source:"http://master.faable.com:31789/hls/marc.m3u8"},a.play=a.play.bind(Object(D.a)(Object(D.a)(a))),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"play",value:function(){this.player.play()}},{key:"render",value:function(){return console.log(this.props.id),o.a.createElement("div",{className:"player"},o.a.createElement(A.a,{url:"http://master.faable.com:31789/hls/".concat(this.props.id,".m3u8"),autoplay:!0,muted:!0}))}}]),t}(a.Component),B=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={room:{},user:{}},n.roomServices=new h,n.userServices=new f,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.roomServices.getOneRoom(this.props.match.params.id).then(function(t){e.setState({room:t}),e.userServices.getOneUser(e.state.room.owner).then(function(t){e.setState({user:t}),console.log(e.state.user)})}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){return console.log(this.state.room._id),o.a.createElement("div",{className:"room"},o.a.createElement("div",{className:"videoplayer"},o.a.createElement("div",{className:"video"},o.a.createElement(z,{id:this.state.room._id})),o.a.createElement("div",{className:"box"},o.a.createElement("div",{className:"title-wrapper"},o.a.createElement("h1",{className:"roomname"},this.state.room.roomname),o.a.createElement("h5",null,this.state.room.description),o.a.createElement("div",{className:"followers-streams"},o.a.createElement("p",null,this.state.room.tags),o.a.createElement("p",null,o.a.createElement(g.a,{icon:"user",className:"profile-icon"})," ",void 0!==this.state.user.username?this.state.user.username:null),o.a.createElement("p",{className:"margin-left"},"Followers: ",this.state.room.followers===[]?this.state.room.followers:"0"))),o.a.createElement("div",{className:"room-button-container"},o.a.createElement("button",{className:"button-follow margin-bottom"},"Follow")))),o.a.createElement("div",{className:"chat"},o.a.createElement("div",{className:"box-chat"},o.a.createElement(W,null))))}}]),t}(a.Component),P=n(8),H=function e(){var t=this;Object(l.a)(this,e),this.signup=function(e,n){return t.service.post("/signup",{username:e,password:n}).then(function(e){return e.data})},this.login=function(e,n){return t.service.post("/login",{username:e,password:n}).then(function(e){return e.data})},this.logout=function(){return t.service.post("/logout",{}).then(function(e){return e.data})},this.loggedin=function(){return t.service.get("/loggedin").then(function(e){return e.data})},this.service=d.a.create({baseURL:"https://rooms-ih.herokuapp.com/api/",withCredentials:!0})},Y=n(37),G=n(24),K=(a.Component,n(80)),V=n.n(K),J=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).logout=function(){n.service.logout().then(function(e){return n.props.setTheUser(null)})},n.service=new H,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.userInSession?(console.log(this.props.userInSession),o.a.createElement("div",{className:"header-absolute"},o.a.createElement("div",{className:"header"},o.a.createElement(P.b,{className:"logo",to:"/map"},o.a.createElement("img",{src:V.a,alt:"rooms"})),o.a.createElement("ul",null,o.a.createElement("li",{id:"user-name"},"Hi ",this.props.userInSession.username,"!"),o.a.createElement("li",null,o.a.createElement(P.b,{to:"/profile/".concat(this.props.userInSession._id)},"Your Profile")),o.a.createElement("li",null," ",o.a.createElement(P.b,{to:""},o.a.createElement("span",{onClick:this.logout},"Sign Out"))))))):o.a.createElement("div",{className:"header-absolute"},o.a.createElement("div",{className:"header"},o.a.createElement(P.b,{to:"/map"},o.a.createElement("img",{src:V.a,alt:"rooms"})),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(P.b,{to:"/signup"},"Sign Up")),o.a.createElement("li",null," ",o.a.createElement(P.b,{to:"/login"},"Log In")))))}}]),t}(a.Component),q=(n(239),n(11)),Z=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).update=function(){n.getRoomOwner(),n.getUserRoom(),n.getFollowingRooms()},n.state={username:"",password:"",room:"",following:[]},n.services=new H,n.roomServices=new h,n.userServices=new f,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.update()}},{key:"getRoomOwner",value:function(){var e=this;this.roomServices.getOneRoom(this.props.match.params.id).then(function(t){e.setState({room:t}),e.userServices.getOneUser(e.state.room.owner).then(function(t){e.setState({user:t})})}).catch(function(e){return console.log(e)})}},{key:"getUserRoom",value:function(){var e=this;console.log(this.props.loggedInUser.room),console.log(this.props.loggedInUser._id),this.roomServices.getOneRoom(this.props.loggedInUser.room).then(function(t){return e.setState({room:t.roomname})}).catch(function(e){return console.log(e)})}},{key:"deleteRoom",value:function(e){var t=this;this.roomServices.deleteRoom(e.room[0]),this.userServices.updateUser(e._id,{room:[]}).then(function(){return t.setState({room:[]})}).catch(function(e){return console.log(e)}),this.props.loggedInUser.room=[]}},{key:"getRoomHeader",value:function(){var e=this;return console.log(this.props.loggedInUser.room),1===this.props.loggedInUser.room.length?o.a.createElement("p",null,"Your room ",this.state.room," ",o.a.createElement(P.b,{to:"/room/".concat(this.props.loggedInUser.room[0])},"Go to your room")," ",o.a.createElement("span",{onClick:function(){return e.deleteRoom(e.props.loggedInUser)}},"Delete room")):o.a.createElement(P.b,{to:"/create"},"Create room")}},{key:"getFollowingRooms",value:function(){var e=this,t=[];this.props.loggedInUser.following.map(function(n){e.roomServices.getOneRoom(n).then(function(n){t.push(n),e.setState({following:t})})})}},{key:"displayFollowingRooms",value:function(){var e=this;return this.state.following.map(function(t){return console.log(t),o.a.createElement("div",{className:"following"},o.a.createElement("div",{className:"following-img"},o.a.createElement("img",{src:t.imageUrl,alt:t.roomname})),o.a.createElement("div",{className:"info-window-content following-content"},o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(g.a,{className:"icon-home",icon:q.c}),o.a.createElement("span",{className:"roomname"},t.roomname),o.a.createElement(g.a,{className:"icon-user",icon:"user"})),o.a.createElement("li",null,o.a.createElement(g.a,{className:"icon",icon:q.f}),o.a.createElement("span",null,t.description))),o.a.createElement("button",{type:"button",className:"info-window-btn",onClick:e.enterRoom},"Enter room")))})}},{key:"render",value:function(){return o.a.createElement("div",{className:"profile-container"},o.a.createElement("div",{className:"profileHeader"},o.a.createElement("img",{className:"profile-pic",src:this.props.loggedInUser.imageUrl}),o.a.createElement("h1",{className:"roomname"},this.props.loggedInUser.username)),o.a.createElement("div",{className:"box box-profile"},o.a.createElement("div",{className:"room-header"},this.getRoomHeader(),o.a.createElement("div",{className:"room-icons"}))),o.a.createElement("div",{className:"box box-profile box-following"},o.a.createElement("div",{className:"room-header"},o.a.createElement("p",null,"Following:"),this.displayFollowingRooms())))}}]),t}(a.Component),Q=n(151),X=n(39),$=function(e){var t=e.component,n=e.user,a=Object(Q.a)(e,["component","user"]);return o.a.createElement(X.b,Object.assign({},a,{render:function(e){return n?o.a.createElement(t,Object.assign({},e,{loggedInUser:n})):o.a.createElement(X.a,{to:{pathname:"/"}})}}))},ee=(n(240),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=e.target,a=t.name,o=t.value;n.state.username||n.setState({usernameCheck:!0}),n.state.password||n.setState({passwordCheck:!0}),n.setState(Object(G.a)({},a,o))},n.handleSubmit=function(e){e.preventDefault();var t=n.state,a=t.username,o=t.password;n.services.signup(a,o).then(function(e){n.setState({username:"",password:""}),n.props.setTheUser(e),window.location.href="/map"}).catch(function(e){console.log("**** Error de signup",e.response.data.message),n.setState({error:e.response.data.message})})},n.state={username:"",password:"",error:!1},n.services=new H,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"validation",value:function(){if(console.log(this.state.error),!1!==this.state.error)return o.a.createElement("div",{className:"alert alert-warning"},o.a.createElement("p",null,this.state.error))}},{key:"render",value:function(){return o.a.createElement("div",{className:"login-form"},o.a.createElement("div",null,o.a.createElement("h1",null,"Sign Up"),o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{onChange:this.handleChange,value:this.state.username,type:"text",id:"username",name:"username",placeholder:"User Name"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{onChange:this.handleChange,value:this.state.password,type:"password",id:"password",name:"password",placeholder:"Password"})),o.a.createElement("button",{type:"submit",className:"signup-link"},"Sign Up"),this.validation())))}}]),t}(a.Component)),te=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=e.target,a=t.name,o=t.value;n.setState(Object(G.a)({},a,o))},n.handleSubmit=function(e){e.preventDefault();var t=n.state,a=t.username,o=t.password;n.services.login(a,o).then(function(e){n.setState({username:"",password:""}),n.props.setTheUser(e),window.location.href="/map"}).catch(function(e){n.setState({error:e.response.data.message}),console.log("**** Error de login",e.response.data.message)})},n.state={username:"",password:"",error:!1},n.services=new H,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"validation",value:function(){if(console.log(this.state.error),!1!==this.state.error)return o.a.createElement("div",{className:"alert alert-warning"},o.a.createElement("p",null,this.state.error))}},{key:"render",value:function(){return o.a.createElement("div",{className:"login-form"},o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("h1",null,"Log In"),o.a.createElement("form",{onSubmit:this.handleSubmit,action:"/map"},o.a.createElement("input",{onChange:this.handleChange,value:this.state.username,type:"text",className:"form-control",id:"username",name:"username",placeholder:"User Name"}),o.a.createElement("input",{onChange:this.handleChange,value:this.state.password,type:"password",className:"form-control",id:"password",name:"password",placeholder:"Password"}),o.a.createElement("button",{type:"submit"},"Log In"),this.validation(),o.a.createElement("div",{className:"login-link"},o.a.createElement("p",null,"Don't have an account yet ?"),o.a.createElement(P.b,{className:"signup-link",to:"/signup"},"Sign Up"))))))}}]),t}(a.Component),ne=n(51),ae=(n(130),n(152)),oe={position:"absolute",width:"100%",height:"100vh",zIndex:-10},re=function(e){function t(e){var n;Object(l.a)(this,t);var a=(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).props.initialCenter,o=a.lat,r=a.lng;return n.state={currentLocation:{lat:o,lng:r}},n.styles=ae,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.centerAroundCurrentLocation&&navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var n=t.coords;e.setState({currentLocation:{lat:n.latitude,lng:n.longitude}})}),this.loadMap()}},{key:"componentDidUpdate",value:function(e,t){e.google!==this.props.google&&this.loadMap(),t.currentLocation!==this.state.currentLocation&&this.recenterMap()}},{key:"loadMap",value:function(){if(this.props&&this.props.google){var e=this.props.google,t=e.maps,n=this.refs.map,a=s.a.findDOMNode(n),o=this.props.zoom,r=this.state.currentLocation,l=r.lat,i=r.lng,c=new e.maps.StyledMapType(this.styles,{name:"Styled Map"}),m=new t.LatLng(l,i),u=Object.assign({},{disableDefaultUI:!0,center:m,zoom:o});this.map=new t.Map(a,u),this.map.mapTypes.set("styled_map",c),this.map.setMapTypeId("styled_map")}}},{key:"randomRoom",value:function(){var e=this.map,t=this.props.google.maps;if(!this.props.randomRoom.location)return null;var n=this.props.randomRoom.location.latitude,a=this.props.randomRoom.location.longitude;if(e){var o=new t.LatLng(n,a);e.panTo(o)}}},{key:"recenterMap",value:function(){var e=this.map,t=this.state.currentLocation,n=this.props.google.maps;if(e){var a=new n.LatLng(t.lat,t.lng);e.panTo(a)}}},{key:"renderChildren",value:function(){var e=this,t=this.props.children;if(t)return o.a.Children.map(t,function(t){if(t)return o.a.cloneElement(t,{map:e.map,google:e.props.google,mapCenter:e.state.currentLocation})})}},{key:"render",value:function(){var e=Object.assign({},oe);return this.props.randomRoom&&this.randomRoom(),o.a.createElement("div",null,o.a.createElement("div",{style:e,ref:"map"},"Loading map..."),this.renderChildren())}}]),t}(o.a.Component),se=re;re.defaultProps={zoom:3,initialCenter:{lat:43.915491,lng:6.972054},centerAroundCurrentLocation:!1,visible:!0};n(253);var le=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=e.target,a=t.name,o=t.value;n.setState(Object(G.a)({},a,o),function(){n.props.search(n.state.search)})},n.state={search:""},n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props)}},{key:"render",value:function(){return o.a.createElement("div",{className:"search-bar"},o.a.createElement("input",{className:"search-input",type:"text",name:"search",value:this.state.search,onChange:this.handleChange,placeholder:"Search"}),o.a.createElement("button",{className:"search-icon",type:"submit"},o.a.createElement(g.a,{className:"search",icon:"search"})))}}]),t}(a.Component),ie=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).infoWindowRef=o.a.createRef(),n.onInfoWindowOpen=n.onInfoWindowOpen.bind(Object(D.a)(Object(D.a)(n))),n.containerElement||(n.containerElement=document.createElement("div")),n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"onInfoWindowOpen",value:function(){s.a.render(o.a.Children.only(this.props.children),this.containerElement),this.infoWindowRef.current.infowindow.setContent(this.containerElement)}},{key:"render",value:function(){return o.a.createElement(ne.InfoWindow,Object.assign({onOpen:this.onInfoWindowOpen,ref:this.infoWindowRef},this.props))}}]),t}(a.Component),ce=(a.Component,function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).update=function(){n.services.getAllRooms().then(function(e){return n.setState({Rooms:e})}).then(function(){return n.setState({filteredRooms:n.state.Rooms})})},n.displayMarkers=function(){var e=n.props.google,t=[];return n.state.filteredRooms.map(function(a){var r={path:e.maps.SymbolPath.CIRCLE,scale:7,fillColor:"tomato",fill:"tomato",fillOpacity:1,strokeWeight:0};t.push(a.followers.length);var s,l=Math.max.apply(null,t);return 1===(s=a.followers.length?a.followers.length/l:0)&&(r.fillColor="#ff4800"),s>=.8&&s<1&&(r.fillColor="#ff6a30"),s>=.6&&s<.8&&(r.fillColor="#ff9166"),s>=.4&&s<.6&&(r.fillColor="#ffbca2"),s<.4&&(r.fillColor="#ffe5db",r.fillOpacity=.5),a.location?o.a.createElement(ne.Marker,{key:a._id,id:a._id,room:a,position:{lat:a.location.latitude,lng:a.location.longitude},icon:r,onClick:n.onMarkerClick}):null})},n.displayButton=function(){return n.props.userInSession?0===n.props.userInSession.room.length?o.a.createElement(P.b,{className:"map-buttons",to:"/create",user:n.props.userInSession},"Create room"):o.a.createElement(P.b,{className:"map-buttons",to:"/room/".concat(n.getUserRoom())},"Go to your room"):o.a.createElement(P.b,{className:"map-buttons",to:"/login"},"Create a room")},n.pickRandom=function(e){var t=Math.floor(Math.random()*(n.state.Rooms.length-0))+0,a=n.state.Rooms[t];n.onClose(),n.setState({selectedRoom:a})},n.onMarkerClick=function(e,t,a){n.userServices.getOneUser(e.room.owner).then(function(a){n.setState({selectedRoom:e.room,activeMarker:t,selectedRoomOwner:a.username,showingInfoWindow:!0,displayViewButton:!0})})},n.search=function(e,t){if(t){var a=Object(Y.a)(n.state.Rooms),o=[];a=a.filter(function(t){t.tags.map(function(n){if(!n.toLowerCase().includes(e.toLowerCase()))return null;o.push(t)}),n.setState({filteredRooms:o})})}else{var r=Object(Y.a)(n.state.Rooms);r=r.filter(function(t){return t.roomname.toLowerCase().includes(e.toLowerCase())}),n.setState({filteredRooms:r})}},n.onClose=function(){n.state.showingInfoWindow&&n.setState({showingInfoWindow:!1,activeMarker:null,displayViewButton:!1,selectedRoom:"",selectedRoomOwner:""})},n.enterRoom=function(){window.location.href="/room/".concat(n.state.selectedRoom._id)},n.handleSearch=function(e){n.search(e,!0),n.onClose()},n.getTags=function(){return n.state.selectedRoom?n.state.selectedRoom.tags?n.state.selectedRoom.tags.map(function(e){return"#"===e[0]?o.a.createElement("button",{key:"0",className:"info-window-tag",onClick:function(){return n.handleSearch(e)}},e):o.a.createElement("button",{key:"1",className:"info-window-tag",onClick:function(){return n.handleSearch(e)}},"#".concat(e," "))}):"The room has no tags":null},n.setFollowButton=function(){return n.props.userInSession?n.props.userInSession.following.includes(n.state.selectedRoom._id)?o.a.createElement("button",{className:"info-window-btn",onClick:function(){return n.unfollowRoom()}},"Unfollow"):o.a.createElement("button",{className:"info-window-btn info-window-following",onClick:function(){return n.followRoom()}},"Follow"):null},n.followRoom=function(){n.state.selectedRoom.followers.push(n.props.userInSession._id),n.props.userInSession.following.push(n.state.selectedRoom._id),n.userServices.updateFollowing(n.state.selectedRoom._id,n.props.userInSession._id,"follow").then(function(){return console.log("------------------------------------follow------------------------------")}).catch(function(){return console.log("-------------------------------------------CATCH----------------------------")}),n.update()},n.unfollowRoom=function(){n.state.selectedRoom.followers.splice(n.state.selectedRoom.followers.indexOf(n.props.userInSession._id),1),n.props.userInSession.following.splice(n.props.userInSession.following.indexOf(n.state.selectedRoom._id),1),n.userServices.updateFollowing(n.state.selectedRoom._id,n.props.userInSession._id,"unfollow").then(function(){return console.log("------------------------------------unfollow------------------------------")}).catch(function(){return console.log("-------------------------------------------CATCH----------------------------")}),n.update()},n.state={showingInfoWindow:!1,activeMarker:{},selectedRoom:"",selectedRoomOwner:"",displayViewButton:!1,Rooms:[],filteredRooms:[]},n.services=new h,n.userServices=new f,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.update()}},{key:"getUserRoom",value:function(){return this.props.userInSession.room[0]}},{key:"hideWindow",value:function(){this.setState({showingInfoWindow:!1})}},{key:"render",value:function(){return o.a.createElement("div",{className:"map-container"},o.a.createElement(le,{search:this.search}),o.a.createElement(se,{randomRoom:this.state.selectedRoom,centerAroundCurrentLocation:!0,google:this.props.google},this.displayMarkers(),o.a.createElement(ie,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow,onClose:this.onClose,className:"info-window-main"},o.a.createElement("div",{className:"info-window"},o.a.createElement("div",{className:"info-window-img"},o.a.createElement("img",{src:this.state.selectedRoom.imageUrl,alt:this.state.selectedRoom.roomname})),o.a.createElement("div",{className:"info-window-content"},o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(g.a,{className:"icon-home",icon:q.c}),o.a.createElement("span",{className:"roomname"},this.state.selectedRoom.roomname),o.a.createElement(g.a,{className:"icon-user",icon:"user"}),o.a.createElement("span",{className:"owner"},this.state.selectedRoomOwner)),o.a.createElement("li",null,o.a.createElement(g.a,{className:"icon",icon:q.f}),o.a.createElement("span",null,this.state.selectedRoom.description)),o.a.createElement("li",null,o.a.createElement(g.a,{className:"icon",icon:q.g}),o.a.createElement("span",null,this.getTags())),o.a.createElement("li",null,o.a.createElement(g.a,{className:"icon",icon:q.i}),o.a.createElement("span",null,this.state.selectedRoom.followers?this.state.selectedRoom.followers.length:"0"," followers"))),o.a.createElement("button",{type:"button",className:"info-window-btn",onClick:this.enterRoom},"Enter room"),this.setFollowButton())))),o.a.createElement("div",{className:"map-menu"},o.a.createElement("button",{type:"submit",className:"map-buttons",onClick:this.pickRandom},"Random room"),this.displayButton()))}}]),t}(a.Component)),me=Object(ne.GoogleApiWrapper)({apiKey:"AIzaSyC9-z5odg8Pfi0AMseMq_6KocFN09_9FSw"})(ce),ue=n(38),pe=(n(254),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=e.target,a=t.name,o=t.value;n.setState({room:Object(ue.a)({},n.state.room,Object(G.a)({},a,o))})},n.handleHiddenChange=function(e,t){n.setState(function(e){return{hidden:t,open:!t&&e.open}})},n.handleSubmit=function(e){e.preventDefault();var t=n.state.room.tags,a=n.getHashTags(t);console.log(a);var o=Object(ue.a)({},n.state.room,{tags:a});n.services.postRoom(o).then(function(e){window.location.href="/room/".concat(e._id)})},n.state={room:{roomname:"",description:"",location:{latitude:void 0,longitude:void 0},tags:"",followers:[],owner:void 0},hidden:!1},n.handleSubmit=n.handleSubmit.bind(Object(D.a)(Object(D.a)(n))),n.services=new h,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.currentLocation(),this.getOwnerId()}},{key:"getOwnerId",value:function(){var e=this;console.log("getOwnerId -> El Id de usuario es:",this.props.userInSession._id),this.setState(Object(ue.a)({},this.state,{room:Object(ue.a)({},this.state.room,{owner:this.props.userInSession._id})}),function(){return console.log("getOwnerId -> El estado es:",e.state.room)})}},{key:"currentLocation",value:function(){var e=this;navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var n=t.coords;e.setState(Object(ue.a)({},e.state,{room:Object(ue.a)({},e.state.room,{location:Object(ue.a)({},e.state.room.location,{latitude:n.latitude,longitude:n.longitude})})}))})}},{key:"getHashTags",value:function(e){for(var t,n=/(?:^|\s)(?:#)([a-zA-Z\d]+)/gm,a=[];t=n.exec(e);)a.push(t[1]);return a}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"create-form"},o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("h1",null,"Create a room"),o.a.createElement("input",{onChange:this.handleChange,value:this.state.room.roomname,type:"text",className:"form-control",id:"roomname",name:"roomname",placeholder:"Name your room"}),o.a.createElement("input",{onChange:this.handleChange,value:this.state.room.description,type:"text",className:"form-control",id:"description",name:"description",placeholder:"Describe your room"}),o.a.createElement("input",{onChange:this.handleChange,value:this.state.room.tags,type:"text",className:"form-control",id:"tags",name:"tags",placeholder:"Tags"}),o.a.createElement("button",{type:"submit"},"Create"))))}}]),t}(a.Component)),de=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).logout=function(){n.service.logout().then(function(e){console.log("esto "+n.closeButton),n.props.setTheUser(null)})},n.service=new H,n.closeButton=document.getElementsByClassName("close-hamb")[0],n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.userInSession?o.a.createElement("div",{className:"pepe"},o.a.createElement("div",{className:"logo-type-hamb"},o.a.createElement(P.b,{to:"/map"},o.a.createElement(g.a,{className:"logo",icon:"person-booth"})),o.a.createElement(P.b,{to:"/map"},o.a.createElement("h3",null,"ROOMS"))),o.a.createElement("nav",{role:"navigation"},o.a.createElement("div",{id:"menuToggle"},o.a.createElement("input",{className:"close-hamb",type:"checkbox"}),o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("ul",{id:"menu"},o.a.createElement("li",null,o.a.createElement(P.b,{to:"/profile"},"Your Profile")),o.a.createElement("li",null," ",o.a.createElement(P.b,{to:"/map"},o.a.createElement("div",{onClick:this.logout},"Sign Out"))))))):o.a.createElement("div",{className:"pepe"},o.a.createElement("div",{className:"logo-type-hamb"},o.a.createElement(P.b,{to:"/map"},o.a.createElement(g.a,{className:"logo",icon:"person-booth"})),o.a.createElement(P.b,{to:"/map"},o.a.createElement("h3",null,"ROOMS"))),o.a.createElement("nav",{role:"navigation"},o.a.createElement("div",{id:"menuToggle"},o.a.createElement("input",{type:"checkbox"}),o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("span",null),o.a.createElement("ul",{id:"menu"},o.a.createElement("li",null,o.a.createElement(P.b,{to:"/profile"},"Your Profile")),o.a.createElement("li",null," ",o.a.createElement(P.b,{to:"/login"},"Log In"))))))}}]),t}(a.Component),he=n(49),fe=n(60),ge=n.n(fe),ve=(a.Component,n(153)),be=n.n(ve),Ee=(n(288),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).setUser=function(e){return n.setState({loggedInUser:e})},n.state={loggedInUser:null,modalShow:!1,modal:!1,displayInfo:!0},n.handleClick=n.handleClick.bind(Object(D.a)(Object(D.a)(n))),n.setUser=n.setUser.bind(Object(D.a)(Object(D.a)(n))),n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleClick",value:function(){this.setState({modalShow:!0}),console.log(this.state.modalShow)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"rooms-index"},o.a.createElement("div",{className:"index-info"},o.a.createElement("img",{src:be.a,alt:"rooms"}),o.a.createElement("p",null,"It\u2019s a social media streaming platform that shares your room with the world\u2026"),o.a.createElement("div",{className:"see-rooms"},o.a.createElement(P.b,{className:"button-search",to:"/map"},"See Rooms")))))}}]),t}(a.Component)),ye=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e))).setUser=function(e){return n.setState({loggedInUser:e})},n.fetchUser=function(){null===n.state.loggedInUser&&n.services.loggedin().then(function(e){return n.setState({loggedInUser:e})}).catch(function(e){return n.setState({loggedInUser:!1})})},n.state={loggedInUser:null},n.services=new H,n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return console.log("este es el loggedInUser en app"+this.state.loggedInUser),this.fetchUser(),this.state.loggedInUser?o.a.createElement("div",null,o.a.createElement(de,{userInSession:this.state.loggedInUser,setTheUser:this.setUser}),o.a.createElement(J,{userInSession:this.state.loggedInUser,setTheUser:this.setUser}),o.a.createElement(X.d,null,o.a.createElement(X.b,{path:"/",exact:!0,render:function(){return o.a.createElement(Ee,{userInSession:e.state.loggedInUser,setUser:e.setUser})}}),o.a.createElement($,{path:"/profile",user:this.state.loggedInUser,component:Z}),o.a.createElement(X.b,{path:"/room/:id",component:B}),o.a.createElement(X.b,{path:"/map",render:function(){return o.a.createElement(me,{userInSession:e.state.loggedInUser,setUser:e.setUser})}}),o.a.createElement(X.b,{path:"/create",render:function(){return o.a.createElement(pe,{userInSession:e.state.loggedInUser,setUser:e.setUser})}}),o.a.createElement(X.b,{path:"/chat",userInSession:this.state.loggedInUser,component:W}),o.a.createElement(X.b,{path:"/streaming",userInSession:this.state.loggedInUser,component:z}))):o.a.createElement("div",null,o.a.createElement(de,{userInSession:this.state.loggedInUser,setTheUser:this.setUser}),o.a.createElement(J,{userInSession:this.state.loggedInUser,setTheUser:this.setUser}),o.a.createElement(X.d,null,o.a.createElement(X.b,{path:"/",exact:!0,render:function(){return o.a.createElement(Ee,{userInSession:e.state.loggedInUser,setUser:e.setUser})}}),o.a.createElement($,{user:this.state.loggedInUser,path:"/profile",component:Z}),o.a.createElement(X.b,{path:"/map",render:function(){return o.a.createElement(me,{userInSession:e.state.loggedInUser,setUser:e.setUser})}}),o.a.createElement(X.b,{path:"/room/:id",component:B}),o.a.createElement(X.b,{path:"/chat",userInSession:this.state.loggedInUser,component:W}),o.a.createElement(X.b,{path:"/signup",render:function(){return o.a.createElement(ee,{setTheUser:e.setUser})}}),o.a.createElement(X.b,{path:"/login",render:function(){return o.a.createElement(te,{setTheUser:e.setUser})}}),o.a.createElement(X.b,{path:"/streaming",userInSession:this.state.loggedInUser,component:z})))}}]),t}(a.Component);he.b.add(q.e,q.d,q.b,q.h,q.a),s.a.render(o.a.createElement(P.a,null,o.a.createElement(ye,null)),document.getElementById("root"))},80:function(e,t,n){e.exports=n.p+"static/media/rooms-r-white.1eb47685.svg"},88:function(e,t,n){},89:function(e,t,n){}},[[154,1,2]]]);
//# sourceMappingURL=main.d98c637a.chunk.js.map